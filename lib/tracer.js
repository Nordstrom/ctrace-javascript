'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var cov_tbhncseuk = function () {
  var path = '/Users/a50r/dev/src/github.com/Nordstrom/ctrace-js/src/tracer.js',
      hash = '8d16287a371a2cadf78a5ebe69db3e4cfe892abb',
      global = new Function('return this')(),
      gcv = '__coverage__',
      coverageData = {
    path: '/Users/a50r/dev/src/github.com/Nordstrom/ctrace-js/src/tracer.js',
    statementMap: {
      '0': {
        start: {
          line: 8,
          column: 12
        },
        end: {
          line: 8,
          column: 14
        }
      },
      '1': {
        start: {
          line: 9,
          column: 0
        },
        end: {
          line: 11,
          column: 1
        }
      },
      '2': {
        start: {
          line: 10,
          column: 2
        },
        end: {
          line: 10,
          column: 45
        }
      },
      '3': {
        start: {
          line: 14,
          column: 14
        },
        end: {
          line: 14,
          column: 19
        }
      },
      '4': {
        start: {
          line: 15,
          column: 10
        },
        end: {
          line: 15,
          column: 11
        }
      },
      '5': {
        start: {
          line: 16,
          column: 2
        },
        end: {
          line: 19,
          column: 33
        }
      },
      '6': {
        start: {
          line: 38,
          column: 4
        },
        end: {
          line: 38,
          column: 78
        }
      },
      '7': {
        start: {
          line: 39,
          column: 4
        },
        end: {
          line: 39,
          column: 49
        }
      },
      '8': {
        start: {
          line: 40,
          column: 4
        },
        end: {
          line: 40,
          column: 78
        }
      },
      '9': {
        start: {
          line: 41,
          column: 4
        },
        end: {
          line: 41,
          column: 26
        }
      },
      '10': {
        start: {
          line: 43,
          column: 4
        },
        end: {
          line: 46,
          column: 5
        }
      },
      '11': {
        start: {
          line: 44,
          column: 6
        },
        end: {
          line: 44,
          column: 69
        }
      },
      '12': {
        start: {
          line: 45,
          column: 6
        },
        end: {
          line: 45,
          column: 65
        }
      },
      '13': {
        start: {
          line: 48,
          column: 18
        },
        end: {
          line: 48,
          column: 37
        }
      },
      '14': {
        start: {
          line: 49,
          column: 4
        },
        end: {
          line: 54,
          column: 5
        }
      },
      '15': {
        start: {
          line: 50,
          column: 6
        },
        end: {
          line: 53,
          column: 7
        }
      },
      '16': {
        start: {
          line: 51,
          column: 19
        },
        end: {
          line: 51,
          column: 41
        }
      },
      '17': {
        start: {
          line: 52,
          column: 8
        },
        end: {
          line: 52,
          column: 64
        }
      },
      '18': {
        start: {
          line: 56,
          column: 4
        },
        end: {
          line: 56,
          column: 77
        }
      },
      '19': {
        start: {
          line: 89,
          column: 16
        },
        end: {
          line: 89,
          column: 33
        }
      },
      '20': {
        start: {
          line: 90,
          column: 14
        },
        end: {
          line: 90,
          column: 77
        }
      },
      '21': {
        start: {
          line: 92,
          column: 19
        },
        end: {
          line: 92,
          column: 26
        }
      },
      '22': {
        start: {
          line: 94,
          column: 18
        },
        end: {
          line: 94,
          column: 24
        }
      },
      '23': {
        start: {
          line: 98,
          column: 4
        },
        end: {
          line: 101,
          column: 5
        }
      },
      '24': {
        start: {
          line: 99,
          column: 6
        },
        end: {
          line: 99,
          column: 27
        }
      },
      '25': {
        start: {
          line: 100,
          column: 6
        },
        end: {
          line: 100,
          column: 27
        }
      },
      '26': {
        start: {
          line: 103,
          column: 4
        },
        end: {
          line: 105,
          column: 5
        }
      },
      '27': {
        start: {
          line: 104,
          column: 6
        },
        end: {
          line: 104,
          column: 27
        }
      },
      '28': {
        start: {
          line: 109,
          column: 4
        },
        end: {
          line: 124,
          column: 5
        }
      },
      '29': {
        start: {
          line: 110,
          column: 6
        },
        end: {
          line: 116,
          column: 7
        }
      },
      '30': {
        start: {
          line: 118,
          column: 6
        },
        end: {
          line: 123,
          column: 7
        }
      },
      '31': {
        start: {
          line: 126,
          column: 4
        },
        end: {
          line: 126,
          column: 36
        }
      },
      '32': {
        start: {
          line: 127,
          column: 4
        },
        end: {
          line: 127,
          column: 22
        }
      },
      '33': {
        start: {
          line: 128,
          column: 4
        },
        end: {
          line: 128,
          column: 17
        }
      },
      '34': {
        start: {
          line: 130,
          column: 4
        },
        end: {
          line: 132,
          column: 5
        }
      },
      '35': {
        start: {
          line: 131,
          column: 6
        },
        end: {
          line: 131,
          column: 27
        }
      },
      '36': {
        start: {
          line: 134,
          column: 4
        },
        end: {
          line: 137,
          column: 5
        }
      },
      '37': {
        start: {
          line: 135,
          column: 6
        },
        end: {
          line: 135,
          column: 27
        }
      },
      '38': {
        start: {
          line: 136,
          column: 6
        },
        end: {
          line: 136,
          column: 42
        }
      },
      '39': {
        start: {
          line: 139,
          column: 4
        },
        end: {
          line: 141,
          column: 5
        }
      },
      '40': {
        start: {
          line: 140,
          column: 6
        },
        end: {
          line: 140,
          column: 25
        }
      },
      '41': {
        start: {
          line: 143,
          column: 4
        },
        end: {
          line: 146,
          column: 6
        }
      },
      '42': {
        start: {
          line: 148,
          column: 4
        },
        end: {
          line: 150,
          column: 5
        }
      },
      '43': {
        start: {
          line: 149,
          column: 6
        },
        end: {
          line: 149,
          column: 30
        }
      },
      '44': {
        start: {
          line: 151,
          column: 4
        },
        end: {
          line: 151,
          column: 28
        }
      },
      '45': {
        start: {
          line: 184,
          column: 24
        },
        end: {
          line: 184,
          column: 49
        }
      },
      '46': {
        start: {
          line: 185,
          column: 4
        },
        end: {
          line: 187,
          column: 5
        }
      },
      '47': {
        start: {
          line: 186,
          column: 6
        },
        end: {
          line: 186,
          column: 54
        }
      },
      '48': {
        start: {
          line: 212,
          column: 24
        },
        end: {
          line: 212,
          column: 49
        }
      },
      '49': {
        start: {
          line: 213,
          column: 4
        },
        end: {
          line: 216,
          column: 5
        }
      },
      '50': {
        start: {
          line: 214,
          column: 16
        },
        end: {
          line: 214,
          column: 53
        }
      },
      '51': {
        start: {
          line: 215,
          column: 6
        },
        end: {
          line: 215,
          column: 25
        }
      },
      '52': {
        start: {
          line: 215,
          column: 15
        },
        end: {
          line: 215,
          column: 25
        }
      },
      '53': {
        start: {
          line: 217,
          column: 4
        },
        end: {
          line: 217,
          column: 20
        }
      },
      '54': {
        start: {
          line: 222,
          column: 4
        },
        end: {
          line: 224,
          column: 5
        }
      },
      '55': {
        start: {
          line: 223,
          column: 6
        },
        end: {
          line: 223,
          column: 12
        }
      },
      '56': {
        start: {
          line: 225,
          column: 4
        },
        end: {
          line: 225,
          column: 40
        }
      },
      '57': {
        start: {
          line: 229,
          column: 16
        },
        end: {
          line: 229,
          column: 21
        }
      },
      '58': {
        start: {
          line: 230,
          column: 12
        },
        end: {
          line: 230,
          column: 13
        }
      },
      '59': {
        start: {
          line: 231,
          column: 4
        },
        end: {
          line: 234,
          column: 35
        }
      }
    },
    fnMap: {
      '0': {
        name: 'genId',
        decl: {
          start: {
            line: 13,
            column: 9
          },
          end: {
            line: 13,
            column: 14
          }
        },
        loc: {
          start: {
            line: 13,
            column: 18
          },
          end: {
            line: 20,
            column: 1
          }
        },
        line: 13
      },
      '1': {
        name: '(anonymous_1)',
        decl: {
          start: {
            line: 37,
            column: 2
          },
          end: {
            line: 37,
            column: 3
          }
        },
        loc: {
          start: {
            line: 37,
            column: 29
          },
          end: {
            line: 57,
            column: 3
          }
        },
        line: 37
      },
      '2': {
        name: '(anonymous_2)',
        decl: {
          start: {
            line: 88,
            column: 2
          },
          end: {
            line: 88,
            column: 3
          }
        },
        loc: {
          start: {
            line: 88,
            column: 33
          },
          end: {
            line: 152,
            column: 3
          }
        },
        line: 88
      },
      '3': {
        name: '(anonymous_3)',
        decl: {
          start: {
            line: 183,
            column: 2
          },
          end: {
            line: 183,
            column: 3
          }
        },
        loc: {
          start: {
            line: 183,
            column: 40
          },
          end: {
            line: 188,
            column: 3
          }
        },
        line: 183
      },
      '4': {
        name: '(anonymous_4)',
        decl: {
          start: {
            line: 211,
            column: 2
          },
          end: {
            line: 211,
            column: 3
          }
        },
        loc: {
          start: {
            line: 211,
            column: 28
          },
          end: {
            line: 218,
            column: 3
          }
        },
        line: 211
      },
      '5': {
        name: '(anonymous_5)',
        decl: {
          start: {
            line: 220,
            column: 2
          },
          end: {
            line: 220,
            column: 3
          }
        },
        loc: {
          start: {
            line: 220,
            column: 18
          },
          end: {
            line: 226,
            column: 3
          }
        },
        line: 220
      },
      '6': {
        name: '(anonymous_6)',
        decl: {
          start: {
            line: 228,
            column: 2
          },
          end: {
            line: 228,
            column: 3
          }
        },
        loc: {
          start: {
            line: 228,
            column: 18
          },
          end: {
            line: 235,
            column: 3
          }
        },
        line: 228
      }
    },
    branchMap: {
      '0': {
        loc: {
          start: {
            line: 37,
            column: 15
          },
          end: {
            line: 37,
            column: 27
          }
        },
        type: 'default-arg',
        locations: [{
          start: {
            line: 37,
            column: 25
          },
          end: {
            line: 37,
            column: 27
          }
        }],
        line: 37
      },
      '1': {
        loc: {
          start: {
            line: 38,
            column: 21
          },
          end: {
            line: 38,
            column: 78
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 38,
            column: 21
          },
          end: {
            line: 38,
            column: 37
          }
        }, {
          start: {
            line: 38,
            column: 41
          },
          end: {
            line: 38,
            column: 78
          }
        }],
        line: 38
      },
      '2': {
        loc: {
          start: {
            line: 39,
            column: 22
          },
          end: {
            line: 39,
            column: 49
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 39,
            column: 22
          },
          end: {
            line: 39,
            column: 40
          }
        }, {
          start: {
            line: 39,
            column: 44
          },
          end: {
            line: 39,
            column: 49
          }
        }],
        line: 39
      },
      '3': {
        loc: {
          start: {
            line: 40,
            column: 17
          },
          end: {
            line: 40,
            column: 78
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 40,
            column: 17
          },
          end: {
            line: 40,
            column: 30
          }
        }, {
          start: {
            line: 40,
            column: 34
          },
          end: {
            line: 40,
            column: 69
          }
        }, {
          start: {
            line: 40,
            column: 73
          },
          end: {
            line: 40,
            column: 78
          }
        }],
        line: 40
      },
      '4': {
        loc: {
          start: {
            line: 43,
            column: 4
          },
          end: {
            line: 46,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 43,
            column: 4
          },
          end: {
            line: 46,
            column: 5
          }
        }, {
          start: {
            line: 43,
            column: 4
          },
          end: {
            line: 46,
            column: 5
          }
        }],
        line: 43
      },
      '5': {
        loc: {
          start: {
            line: 49,
            column: 4
          },
          end: {
            line: 54,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 49,
            column: 4
          },
          end: {
            line: 54,
            column: 5
          }
        }, {
          start: {
            line: 49,
            column: 4
          },
          end: {
            line: 54,
            column: 5
          }
        }],
        line: 49
      },
      '6': {
        loc: {
          start: {
            line: 52,
            column: 34
          },
          end: {
            line: 52,
            column: 44
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 52,
            column: 34
          },
          end: {
            line: 52,
            column: 38
          }
        }, {
          start: {
            line: 52,
            column: 42
          },
          end: {
            line: 52,
            column: 44
          }
        }],
        line: 52
      },
      '7': {
        loc: {
          start: {
            line: 56,
            column: 23
          },
          end: {
            line: 56,
            column: 77
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 56,
            column: 23
          },
          end: {
            line: 56,
            column: 42
          }
        }, {
          start: {
            line: 56,
            column: 46
          },
          end: {
            line: 56,
            column: 77
          }
        }],
        line: 56
      },
      '8': {
        loc: {
          start: {
            line: 88,
            column: 19
          },
          end: {
            line: 88,
            column: 31
          }
        },
        type: 'default-arg',
        locations: [{
          start: {
            line: 88,
            column: 29
          },
          end: {
            line: 88,
            column: 31
          }
        }],
        line: 88
      },
      '9': {
        loc: {
          start: {
            line: 90,
            column: 14
          },
          end: {
            line: 90,
            column: 77
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 90,
            column: 15
          },
          end: {
            line: 90,
            column: 30
          }
        }, {
          start: {
            line: 90,
            column: 34
          },
          end: {
            line: 90,
            column: 57
          }
        }, {
          start: {
            line: 90,
            column: 62
          },
          end: {
            line: 90,
            column: 77
          }
        }],
        line: 90
      },
      '10': {
        loc: {
          start: {
            line: 98,
            column: 4
          },
          end: {
            line: 101,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 98,
            column: 4
          },
          end: {
            line: 101,
            column: 5
          }
        }, {
          start: {
            line: 98,
            column: 4
          },
          end: {
            line: 101,
            column: 5
          }
        }],
        line: 98
      },
      '11': {
        loc: {
          start: {
            line: 98,
            column: 8
          },
          end: {
            line: 98,
            column: 40
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 98,
            column: 8
          },
          end: {
            line: 98,
            column: 11
          }
        }, {
          start: {
            line: 98,
            column: 15
          },
          end: {
            line: 98,
            column: 26
          }
        }, {
          start: {
            line: 98,
            column: 30
          },
          end: {
            line: 98,
            column: 40
          }
        }],
        line: 98
      },
      '12': {
        loc: {
          start: {
            line: 103,
            column: 4
          },
          end: {
            line: 105,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 103,
            column: 4
          },
          end: {
            line: 105,
            column: 5
          }
        }, {
          start: {
            line: 103,
            column: 4
          },
          end: {
            line: 105,
            column: 5
          }
        }],
        line: 103
      },
      '13': {
        loc: {
          start: {
            line: 103,
            column: 8
          },
          end: {
            line: 103,
            column: 26
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 103,
            column: 8
          },
          end: {
            line: 103,
            column: 11
          }
        }, {
          start: {
            line: 103,
            column: 15
          },
          end: {
            line: 103,
            column: 26
          }
        }],
        line: 103
      },
      '14': {
        loc: {
          start: {
            line: 109,
            column: 4
          },
          end: {
            line: 124,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 109,
            column: 4
          },
          end: {
            line: 124,
            column: 5
          }
        }, {
          start: {
            line: 109,
            column: 4
          },
          end: {
            line: 124,
            column: 5
          }
        }],
        line: 109
      },
      '15': {
        loc: {
          start: {
            line: 126,
            column: 14
          },
          end: {
            line: 126,
            column: 36
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 126,
            column: 14
          },
          end: {
            line: 126,
            column: 27
          }
        }, {
          start: {
            line: 126,
            column: 31
          },
          end: {
            line: 126,
            column: 36
          }
        }],
        line: 126
      },
      '16': {
        loc: {
          start: {
            line: 130,
            column: 4
          },
          end: {
            line: 132,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 130,
            column: 4
          },
          end: {
            line: 132,
            column: 5
          }
        }, {
          start: {
            line: 130,
            column: 4
          },
          end: {
            line: 132,
            column: 5
          }
        }],
        line: 130
      },
      '17': {
        loc: {
          start: {
            line: 134,
            column: 4
          },
          end: {
            line: 137,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 134,
            column: 4
          },
          end: {
            line: 137,
            column: 5
          }
        }, {
          start: {
            line: 134,
            column: 4
          },
          end: {
            line: 137,
            column: 5
          }
        }],
        line: 134
      },
      '18': {
        loc: {
          start: {
            line: 135,
            column: 15
          },
          end: {
            line: 135,
            column: 27
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 135,
            column: 15
          },
          end: {
            line: 135,
            column: 21
          }
        }, {
          start: {
            line: 135,
            column: 25
          },
          end: {
            line: 135,
            column: 27
          }
        }],
        line: 135
      },
      '19': {
        loc: {
          start: {
            line: 139,
            column: 4
          },
          end: {
            line: 141,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 139,
            column: 4
          },
          end: {
            line: 141,
            column: 5
          }
        }, {
          start: {
            line: 139,
            column: 4
          },
          end: {
            line: 141,
            column: 5
          }
        }],
        line: 139
      },
      '20': {
        loc: {
          start: {
            line: 148,
            column: 4
          },
          end: {
            line: 150,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 148,
            column: 4
          },
          end: {
            line: 150,
            column: 5
          }
        }, {
          start: {
            line: 148,
            column: 4
          },
          end: {
            line: 150,
            column: 5
          }
        }],
        line: 148
      },
      '21': {
        loc: {
          start: {
            line: 186,
            column: 6
          },
          end: {
            line: 186,
            column: 54
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 186,
            column: 6
          },
          end: {
            line: 186,
            column: 17
          }
        }, {
          start: {
            line: 186,
            column: 21
          },
          end: {
            line: 186,
            column: 54
          }
        }],
        line: 186
      },
      '22': {
        loc: {
          start: {
            line: 214,
            column: 16
          },
          end: {
            line: 214,
            column: 53
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 214,
            column: 16
          },
          end: {
            line: 214,
            column: 28
          }
        }, {
          start: {
            line: 214,
            column: 32
          },
          end: {
            line: 214,
            column: 53
          }
        }],
        line: 214
      },
      '23': {
        loc: {
          start: {
            line: 215,
            column: 6
          },
          end: {
            line: 215,
            column: 25
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 215,
            column: 6
          },
          end: {
            line: 215,
            column: 25
          }
        }, {
          start: {
            line: 215,
            column: 6
          },
          end: {
            line: 215,
            column: 25
          }
        }],
        line: 215
      },
      '24': {
        loc: {
          start: {
            line: 222,
            column: 4
          },
          end: {
            line: 224,
            column: 5
          }
        },
        type: 'if',
        locations: [{
          start: {
            line: 222,
            column: 4
          },
          end: {
            line: 224,
            column: 5
          }
        }, {
          start: {
            line: 222,
            column: 4
          },
          end: {
            line: 224,
            column: 5
          }
        }],
        line: 222
      },
      '25': {
        loc: {
          start: {
            line: 222,
            column: 8
          },
          end: {
            line: 222,
            column: 35
          }
        },
        type: 'binary-expr',
        locations: [{
          start: {
            line: 222,
            column: 8
          },
          end: {
            line: 222,
            column: 19
          }
        }, {
          start: {
            line: 222,
            column: 23
          },
          end: {
            line: 222,
            column: 35
          }
        }],
        line: 222
      }
    },
    s: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0,
      '7': 0,
      '8': 0,
      '9': 0,
      '10': 0,
      '11': 0,
      '12': 0,
      '13': 0,
      '14': 0,
      '15': 0,
      '16': 0,
      '17': 0,
      '18': 0,
      '19': 0,
      '20': 0,
      '21': 0,
      '22': 0,
      '23': 0,
      '24': 0,
      '25': 0,
      '26': 0,
      '27': 0,
      '28': 0,
      '29': 0,
      '30': 0,
      '31': 0,
      '32': 0,
      '33': 0,
      '34': 0,
      '35': 0,
      '36': 0,
      '37': 0,
      '38': 0,
      '39': 0,
      '40': 0,
      '41': 0,
      '42': 0,
      '43': 0,
      '44': 0,
      '45': 0,
      '46': 0,
      '47': 0,
      '48': 0,
      '49': 0,
      '50': 0,
      '51': 0,
      '52': 0,
      '53': 0,
      '54': 0,
      '55': 0,
      '56': 0,
      '57': 0,
      '58': 0,
      '59': 0
    },
    f: {
      '0': 0,
      '1': 0,
      '2': 0,
      '3': 0,
      '4': 0,
      '5': 0,
      '6': 0
    },
    b: {
      '0': [0],
      '1': [0, 0],
      '2': [0, 0],
      '3': [0, 0, 0],
      '4': [0, 0],
      '5': [0, 0],
      '6': [0, 0],
      '7': [0, 0],
      '8': [0],
      '9': [0, 0, 0],
      '10': [0, 0],
      '11': [0, 0, 0],
      '12': [0, 0],
      '13': [0, 0],
      '14': [0, 0],
      '15': [0, 0],
      '16': [0, 0],
      '17': [0, 0],
      '18': [0, 0],
      '19': [0, 0],
      '20': [0, 0],
      '21': [0, 0],
      '22': [0, 0],
      '23': [0, 0],
      '24': [0, 0],
      '25': [0, 0]
    },
    _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
  },
      coverage = global[gcv] || (global[gcv] = {});

  if (coverage[path] && coverage[path].hash === hash) {
    return coverage[path];
  }

  coverageData.hash = hash;
  return coverage[path] = coverageData;
}();

var _opentracing = require('opentracing');

var _span = require('./span.js');

var _span2 = _interopRequireDefault(_span);

var _reporter = require('./reporter.js');

var _reporter2 = _interopRequireDefault(_reporter);

var _encoder = require('./encoder.js');

var _encoder2 = _interopRequireDefault(_encoder);

var _crypto = require('crypto');

var _textPropagator = require('./propagators/textPropagator');

var _textPropagator2 = _interopRequireDefault(_textPropagator);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const bth = (++cov_tbhncseuk.s[0], []);
++cov_tbhncseuk.s[1];
for (var i = 0; i < 256; ++i) {
  ++cov_tbhncseuk.s[2];

  bth[i] = (i + 0x100).toString(16).substr(1);
}

function genId() {
  ++cov_tbhncseuk.f[0];

  const buf = (++cov_tbhncseuk.s[3], (0, _crypto.randomBytes)(8));
  let i = (++cov_tbhncseuk.s[4], 0);
  ++cov_tbhncseuk.s[5];
  return bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]];
}

/**
 * Tracer is the tracing entry-point.  It facilitates starting a new span and
 * context propagation (ie. inject, extract).
 */
class Tracer {
  /**
   * Construct a new tracer for internal use only.  Use {@link GlobalTracer#init} to set global trace options.
   *
   * @param {object} options - options used to initialize tracer
   * @param {bool} [options.multiEvent] - true for multi-event mode; otherwise, single-event mode
   * @param {bool} [options.debug] - true for debug; otherwise, it is disabled
   * @param {object.<string, Propagators>} [options.propagators] - optional propagators
   * @param {string} [options.serviceName] - allows the configuration of the "service" tag for the entire Tracer if not
   *                                         specified here, can also be set using env variable "ctrace_service_name"
   */
  constructor(options = (++cov_tbhncseuk.b[0][0], {})) {
    ++cov_tbhncseuk.f[1];
    ++cov_tbhncseuk.s[6];

    this._reporter = (++cov_tbhncseuk.b[1][0], options.reporter) || (++cov_tbhncseuk.b[1][1], new _reporter2.default(_encoder2.default, options.stream));
    ++cov_tbhncseuk.s[7];
    this.multiEvent = (++cov_tbhncseuk.b[2][0], options.multiEvent) || (++cov_tbhncseuk.b[2][1], false);
    ++cov_tbhncseuk.s[8];
    this.debug = (++cov_tbhncseuk.b[3][0], options.debug) || (++cov_tbhncseuk.b[3][1], process.env.ctrace_debug === 'true') || (++cov_tbhncseuk.b[3][2], false);
    ++cov_tbhncseuk.s[9];
    this._propagation = {};

    ++cov_tbhncseuk.s[10];
    if (!options.replacePropagators) {
      ++cov_tbhncseuk.b[4][0];
      ++cov_tbhncseuk.s[11];

      this._propagation[_opentracing.FORMAT_HTTP_HEADERS] = [new _textPropagator2.default()];
      ++cov_tbhncseuk.s[12];
      this._propagation[_opentracing.FORMAT_TEXT_MAP] = [new _textPropagator2.default()];
    } else {
      ++cov_tbhncseuk.b[4][1];
    }

    const props = (++cov_tbhncseuk.s[13], options.propagators);
    ++cov_tbhncseuk.s[14];
    if (props) {
      ++cov_tbhncseuk.b[5][0];
      ++cov_tbhncseuk.s[15];

      for (let key of Object.keys(props)) {
        let list = (++cov_tbhncseuk.s[16], this._propagation[key]);
        ++cov_tbhncseuk.s[17];
        this._propagation[key] = ((++cov_tbhncseuk.b[6][0], list) || (++cov_tbhncseuk.b[6][1], [])).concat(props[key]);
      }
    } else {
      ++cov_tbhncseuk.b[5][1];
    }
    // Can specify "service" tag for the entire Tracer using options or environment variable "ctrace_service_name"
    ++cov_tbhncseuk.s[18];
    this.serviceName = (++cov_tbhncseuk.b[7][0], options.serviceName) || (++cov_tbhncseuk.b[7][1], process.env.ctrace_service_name);
  }

  // ---------------------------------------------------------------------- //
  // OpenTracing API methods
  // ---------------------------------------------------------------------- //

  /**
   * Starts and returns a new Span representing a logical unit of work.
   *
   * For example:
   *
   *     // Start a new (parentless) root Span:
   *     let parent = tracer.startSpan('DoWork')
   *
   *     // Start a new (child) Span:
   *     let child = tracer.startSpan('Subroutine', {
   *         childOf: parent,
   *     });
   *
   * @param {string} name - the name of the operation.
   * @param {object} [options] - the fields to set on the newly created span.
   * @param {Span|SpanContext} [options.childOf] - a parent SpanContext (or Span,
   *        for convenience) that the newly-started span will be the child of
   *        (per REFERENCE_CHILD_OF). If specified, `fields.references` must
   *        be unspecified.
   * @param {object.<string, object>} [options.tags] - set of key-value pairs which will be set
   *        as tags on the newly created Span. Ownership of the object is
   *        passed to the created span for efficiency reasons (the caller
   *        should not modify this object after calling startSpan).
   * @return {Span} a new Span object.
   */
  startSpan(name, options = (++cov_tbhncseuk.b[8][0], {})) {
    ++cov_tbhncseuk.f[2];

    const now = (++cov_tbhncseuk.s[19], Date.now() * 1000);
    let ref = (++cov_tbhncseuk.s[20], (++cov_tbhncseuk.b[9][0], options.childOf) && (++cov_tbhncseuk.b[9][1], options.childOf._fields) || (++cov_tbhncseuk.b[9][2], options.childOf));

    const spanId = (++cov_tbhncseuk.s[21], genId());

    let traceId = (++cov_tbhncseuk.s[22], spanId);
    let parentId;
    let baggage;

    ++cov_tbhncseuk.s[23];
    if ((++cov_tbhncseuk.b[11][0], ref) && (++cov_tbhncseuk.b[11][1], ref.traceId) && (++cov_tbhncseuk.b[11][2], ref.spanId)) {
      ++cov_tbhncseuk.b[10][0];
      ++cov_tbhncseuk.s[24];

      traceId = ref.traceId;
      ++cov_tbhncseuk.s[25];
      parentId = ref.spanId;
    } else {
      ++cov_tbhncseuk.b[10][1];
    }

    ++cov_tbhncseuk.s[26];
    if ((++cov_tbhncseuk.b[13][0], ref) && (++cov_tbhncseuk.b[13][1], ref.baggage)) {
      ++cov_tbhncseuk.b[12][0];
      ++cov_tbhncseuk.s[27];

      baggage = ref.baggage;
    } else {
      ++cov_tbhncseuk.b[12][1];
    }

    let f;

    ++cov_tbhncseuk.s[28];
    if (parentId) {
      ++cov_tbhncseuk.b[14][0];
      ++cov_tbhncseuk.s[29];

      f = {
        traceId: traceId,
        spanId: spanId,
        parentId: parentId,
        operation: name,
        start: now
      };
    } else {
      ++cov_tbhncseuk.b[14][1];
      ++cov_tbhncseuk.s[30];

      f = {
        traceId: traceId,
        spanId: spanId,
        operation: name,
        start: now
      };
    }

    ++cov_tbhncseuk.s[31];
    f.debug = (++cov_tbhncseuk.b[15][0], options.debug) || (++cov_tbhncseuk.b[15][1], false);
    ++cov_tbhncseuk.s[32];
    f.operation = name;
    ++cov_tbhncseuk.s[33];
    f.start = now;

    ++cov_tbhncseuk.s[34];
    if (options.tags) {
      ++cov_tbhncseuk.b[16][0];
      ++cov_tbhncseuk.s[35];

      f.tags = options.tags;
    } else {
      ++cov_tbhncseuk.b[16][1];
    }

    ++cov_tbhncseuk.s[36];
    if (this.serviceName) {
      ++cov_tbhncseuk.b[17][0];
      ++cov_tbhncseuk.s[37];

      f.tags = (++cov_tbhncseuk.b[18][0], f.tags) || (++cov_tbhncseuk.b[18][1], {});
      ++cov_tbhncseuk.s[38];
      f.tags["service"] = this.serviceName;
    } else {
      ++cov_tbhncseuk.b[17][1];
    }

    ++cov_tbhncseuk.s[39];
    if (baggage) {
      ++cov_tbhncseuk.b[19][0];
      ++cov_tbhncseuk.s[40];

      f.baggage = baggage;
    } else {
      ++cov_tbhncseuk.b[19][1];
    }

    ++cov_tbhncseuk.s[41];
    f.logs = [{
      timestamp: now,
      event: 'Start-Span'
    }];

    ++cov_tbhncseuk.s[42];
    if (this.multiEvent) {
      ++cov_tbhncseuk.b[20][0];
      ++cov_tbhncseuk.s[43];

      this._reporter.report(f);
    } else {
      ++cov_tbhncseuk.b[20][1];
    }
    ++cov_tbhncseuk.s[44];
    return new _span2.default(this, f);
  }

  /**
   * Injects the given SpanContext instance for cross-process propagation
   * within `carrier`. The expected type of `carrier` depends on the value of
   * `format.
   *
   * OpenTracing defines a common set of `format` values (see
   * FORMAT_TEXT_MAP, FORMAT_HTTP_HEADERS, and FORMAT_BINARY), and each has
   * an expected carrier type.
   *
   * Consider this pseudocode example:
   *
   *     var clientSpan = ...;
   *     ...
   *     // Inject clientSpan into a text carrier.
   *     var headersCarrier = {};
   *     Tracer.inject(clientSpan.context(), Tracer.FORMAT_HTTP_HEADERS, headersCarrier);
   *     // Incorporate the textCarrier into the outbound HTTP request header
   *     // map.
   *     Object.assign(outboundHTTPReq.headers, headersCarrier);
   *     // ... send the httpReq
   *
   * @param  {SpanContext} spanContext - the SpanContext to inject into the
   *         carrier object. As a convenience, a Span instance may be passed
   *         in instead (in which case its .context() is used for the
   *         inject()).
   * @param  {string} format - the format of the carrier.
   * @param  {object} carrier - see the documentation for the chosen `format`
   *         for a description of the carrier object.
   */
  inject(spanContext, format, carrier) {
    ++cov_tbhncseuk.f[3];

    const propagation = (++cov_tbhncseuk.s[45], this._propagation[format]);
    ++cov_tbhncseuk.s[46];
    for (let prop of propagation) {
      ++cov_tbhncseuk.s[47];

      (++cov_tbhncseuk.b[21][0], prop.inject) && (++cov_tbhncseuk.b[21][1], prop.inject(spanContext, carrier));
    }
  }

  /**
   * Returns a SpanContext instance extracted from `carrier` in the given
   * `format`.
   *
   * OpenTracing defines a common set of `format` values (see
   * FORMAT_TEXT_MAP, FORMAT_HTTP_HEADERS, and FORMAT_BINARY), and each has
   * an expected carrier type.
   *
   * Consider this pseudocode example:
   *
   *     // Use the inbound HTTP request's headers as a text map carrier.
   *     var headersCarrier = inboundHTTPReq.headers;
   *     var wireCtx = Tracer.extract(Tracer.FORMAT_HTTP_HEADERS, headersCarrier);
   *     var serverSpan = Tracer.startSpan('...', { childOf : wireCtx });
   *
   * @param  {string} format - the format of the carrier.
   * @param  {object} carrier - the type of the carrier object is determined by
   *         the format.
   * @return {SpanContext} - The extracted SpanContext, or undefined if no such SpanContext could
   *         be found in `carrier`
   */
  extract(format, carrier) {
    ++cov_tbhncseuk.f[4];

    const propagation = (++cov_tbhncseuk.s[48], this._propagation[format]);
    ++cov_tbhncseuk.s[49];
    for (let prop of propagation) {
      let ctx = (++cov_tbhncseuk.s[50], (++cov_tbhncseuk.b[22][0], prop.extract) && (++cov_tbhncseuk.b[22][1], prop.extract(carrier)));
      ++cov_tbhncseuk.s[51];
      if (ctx) {
          ++cov_tbhncseuk.b[23][0];
          ++cov_tbhncseuk.s[52];
          return ctx;
        } else {
        ++cov_tbhncseuk.b[23][1];
      }
    }
    ++cov_tbhncseuk.s[53];
    return undefined;
  }

  report(fields) {
    ++cov_tbhncseuk.f[5];
    ++cov_tbhncseuk.s[54];

    // if tracer.debug is false and span.debug is true, don't log this span
    if ((++cov_tbhncseuk.b[25][0], !this.debug) && (++cov_tbhncseuk.b[25][1], fields.debug)) {
      ++cov_tbhncseuk.b[24][0];
      ++cov_tbhncseuk.s[55];

      return;
    } else {
      ++cov_tbhncseuk.b[24][1];
    }
    ++cov_tbhncseuk.s[56];
    return this._reporter.report(fields);
  }

  static genId() {
    ++cov_tbhncseuk.f[6];

    const buf = (++cov_tbhncseuk.s[57], (0, _crypto.randomBytes)(8));
    let i = (++cov_tbhncseuk.s[58], 0);
    ++cov_tbhncseuk.s[59];
    return bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]] + bth[buf[i++]];
  }
}
exports.default = Tracer;
module.exports = exports['default'];